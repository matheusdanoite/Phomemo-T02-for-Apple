import{r as x,j as e,a as M,c as W,d as z,s as P,b as D}from"./firebaseConfig-BnFT8Uei.js";/* empty css                */function I({onBack:U,initialTab:A}){const[d,_]=x.useState(A||"text"),[w,B]=x.useState(""),[u,F]=x.useState(48),[h,C]=x.useState("sans-serif"),[f,N]=x.useState("center"),[T,j]=x.useState("idle"),y=x.useRef(null);x.useEffect(()=>{d==="text"?H():R()},[w,u,h,f,d]);const H=()=>{const n=y.current;if(!n)return;const t=n.getContext("2d"),l=384,g=20,m=l-g*2;t.font=`${u}px ${h}`;const v=u*1.2,b=w.split(`
`),r=[],k=a=>{const o=[];let s=a;for(;s.length>0&&t.measureText(s).width>m;){let i="",c=0;for(;c<s.length&&t.measureText(i+s[c]).width<=m;)i+=s[c],c++;c===0&&(i=s[0],c=1),o.push(i),s=s.substring(c)}return s.length>0&&o.push(s),o};b.forEach(a=>{if(a===""){r.push("");return}const o=a.split(" ");let s="";o.forEach(i=>{const L=s+(s===""?"":" ")+i;if(t.measureText(L).width<=m)s=L;else if(s!==""&&(r.push(s),s=""),t.measureText(i).width<=m)s=i;else{const S=k(i);for(let E=0;E<S.length-1;E++)r.push(S[E]);s=S[S.length-1]}}),s!==""&&r.push(s)});const p=r.length*v+g*2;n.width=l,n.height=p,t.fillStyle="white",t.fillRect(0,0,n.width,n.height),t.fillStyle="black",t.font=`${u}px ${h}`,t.textBaseline="top",r.forEach((a,o)=>{const s=g+o*v;let i=g;const c=t.measureText(a).width;f==="center"?i=(l-c)/2:f==="right"&&(i=l-c-g),t.fillText(a,i,s)})},R=()=>{const n=y.current;if(!n)return;const t=n.getContext("2d"),l=384,g=w.replace(/\n/g," ");t.font=`${u}px ${h}`;let m=0;const v=[];for(let r of g){const p=t.measureText(r).width,a=p+10;v.push({char:r,h:a,w:p}),m+=a}n.width=l,n.height=Math.max(m,200),t.fillStyle="white",t.fillRect(0,0,n.width,n.height),t.fillStyle="black",t.font=`${u}px ${h}`,t.textBaseline="middle",t.textAlign="center";let b=0;t.save(),v.forEach(r=>{const{char:k,h:p}=r,a=l/2,o=b+p/2;t.save(),t.translate(a,o),t.rotate(Math.PI/2),t.fillText(k,0,0),t.restore(),b+=p}),t.restore()},$=async()=>{j("processing");try{const l=y.current.toDataURL("image/png").split(",")[1];window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.printHandler?(window.webkit.messageHandlers.printHandler.postMessage({base64:l,type:"text_render"}),j("success"),setTimeout(()=>j("idle"),2e3)):(await M(W(z,"print_jobs"),{data:l,timestamp:P(),status:"pending",type:"text_render"}),j("success"),setTimeout(()=>j("idle"),3e3))}catch(n){console.error(n),j("error"),alert("Error generating print: "+n.message)}};return e.jsxs("div",{className:"text-app-container",children:[e.jsx("h1",{style:{fontSize:"2.6rem"},children:"Faixa"}),d&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"controls",children:[e.jsxs("div",{className:"control-group",children:[e.jsx("label",{children:"Tamanho da Fonte"}),e.jsx("input",{type:"range",min:d==="banner"?150:20,max:d==="banner"?300:100,value:u,onChange:n=>F(Number(n.target.value))})]}),e.jsxs("div",{className:"control-group",children:[e.jsx("label",{children:"Fonte"}),e.jsxs("div",{className:"button-group",children:[e.jsx("button",{className:h==="sans-serif"?"active":"",onClick:()=>C("sans-serif"),children:"Sans"}),e.jsx("button",{className:h==="serif"?"active":"",onClick:()=>C("serif"),children:"Serif"}),e.jsx("button",{className:h==='"Comic Sans MS"'?"active":"",onClick:()=>C('"Comic Sans MS"'),children:"Comic"})]})]}),d==="text"&&e.jsxs("div",{className:"control-group",children:[e.jsx("label",{children:"Alinhamento"}),e.jsxs("div",{className:"button-group",children:[e.jsx("button",{className:f==="left"?"active":"",onClick:()=>N("left"),title:"Left Align",children:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"17",y1:"10",x2:"3",y2:"10"}),e.jsx("line",{x1:"21",y1:"6",x2:"3",y2:"6"}),e.jsx("line",{x1:"21",y1:"14",x2:"3",y2:"14"}),e.jsx("line",{x1:"17",y1:"18",x2:"3",y2:"18"})]})}),e.jsx("button",{className:f==="center"?"active":"",onClick:()=>N("center"),title:"Center Align",children:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"21",y1:"6",x2:"3",y2:"6"}),e.jsx("line",{x1:"17",y1:"10",x2:"7",y2:"10"}),e.jsx("line",{x1:"19",y1:"14",x2:"5",y2:"14"}),e.jsx("line",{x1:"21",y1:"18",x2:"3",y2:"18"})]})}),e.jsx("button",{className:f==="right"?"active":"",onClick:()=>N("right"),title:"Right Align",children:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"21",y1:"10",x2:"7",y2:"10"}),e.jsx("line",{x1:"21",y1:"6",x2:"3",y2:"6"}),e.jsx("line",{x1:"21",y1:"14",x2:"3",y2:"14"}),e.jsx("line",{x1:"21",y1:"18",x2:"7",y2:"18"})]})})]})]})]}),e.jsx("div",{className:"input-area",children:e.jsx("textarea",{value:w,onChange:n=>B(n.target.value),placeholder:"Escreva aqui..."})}),e.jsxs("div",{className:"preview-area",children:[e.jsx("h3",{children:"Pré-visualização"}),e.jsx("canvas",{ref:y,className:"preview-canvas"})]}),e.jsx("button",{className:"print-button",onClick:$,disabled:T==="processing",children:T==="processing"?"Processing...":"Imprimir"}),T==="success"&&e.jsx("div",{className:"success-toast",children:"Enviado!"})]})]})}D.createRoot(document.getElementById("root")).render(e.jsx(x.StrictMode,{children:e.jsx(I,{initialTab:"banner"})}));
